<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Demo - Hydrafiles</title>
    <meta name="title" content="Hydrafiles - The web privacy layer">
    <meta property="og:title" content="Hydrafiles - The web privacy layer">
    <meta name="twitter:title" content="Hydrafiles - The web privacy layer">
    <meta itemprop="name" content="Hydrafiles - The web privacy layer">
    <meta property="og:site_name" content="Hydrafiles">
    <meta name="application-name" content="Hydrafiles">
    <meta name="apple-mobile-web-app-title" content="Hydrafiles">
    <meta name="twitter:domain" content="Hydrafiles">

    <meta property="og:description" content="Hydrafiles is The web privacy layer. Hydrafiles allows for anyone to serve files and dynamic APIs anonymously via HTTP.">
    <meta name="description" content="Hydrafiles is The web privacy layer. Hydrafiles allows for anyone to serve files and dynamic APIs anonymously via HTTP.">
    <meta name="twitter:description" content="Hydrafiles is The web privacy layer. Hydrafiles allows for anyone to serve files and dynamic APIs anonymously via HTTP.">
    <meta name="abstract" content="Hydrafiles is The web privacy layer. Hydrafiles allows for anyone to serve files and dynamic APIs anonymously via HTTP.">
    <meta itemprop="description" content="Hydrafiles is The web privacy layer. Hydrafiles allows for anyone to serve files and dynamic APIs anonymously via HTTP.">

    <meta name="twitter:image" content="/favicon.ico">
    <meta name="twitter:image:src" content="/favicon.ico">
    <meta name="twitter:image:alt" content="The Hydrafiles Emblem">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="mask-icon" href="/favicon.ico" color="#da9100">
    <meta property="og:image" content="/favicon.ico">
    <meta property="og:image:url" content="/favicon.ico">
    <meta property="og:image:secure_url" content="/favicon.ico">
    <meta property="og:image:type" content="image/x-icon">
    <meta property="og:image:width" content="256">
    <meta property="og:image:height" content="256">
    <meta property="og:image:alt" content="The Hydrafiles Emblem">
    <meta itemprop="image" content="/favicon.ico">
    <link rel="icon" type="image/svg+xml" href="/favicon.ico">
    <link rel="apple-touch-icon" href="/favicon.ico">

    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">

    <meta property="og:locale" content="en">
    <meta name="language" content="en">

    <link rel="canonical" href="https://hydrafiles.com/demo.html">
    <meta property="og:url" content="https://hydrafiles.com/demo.html">
    <meta name="twitter:url" content="https://hydrafiles.com/demo.html">
    <meta property="og:see_also" content="https://hydrafiles.com/demo.html">

    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <meta name="keywords" content="hydrafiles, anonymous, privacy, private, files, file, share, sharing, host, hosting">
    <meta name="rating" content="general">
    <meta name="theme-color" content="#da9100">

    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Hydrafiles",
        "description": "Hydrafiles is The web privacy layer. Hydrafiles allows for anyone to serve files and dynamic APIs anonymously via HTTP.. ",
        "image": "/favicon.ico",
        "url": "https://hydrafiles.com"
    }
    </script>

    <style>
        * {
            word-wrap: break-word 
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f4f4f4;
        }
        header {
            background-color: #333;
            color: #fff;
            width: 100%;
            padding: 1em 0;
            text-align: center;
        }
        section {
            width: 80%;
            margin: 2em 0;
            padding: 1em;
            background-color: #fff;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            margin: 0;
        }
        h2 {
            border-bottom: 2px solid #333;
            padding-bottom: 0.5em;
        }
        table {
            border-collapse: collapse;
        }
        pre {
            word-break: break-all;
            white-space: pre-wrap;
        }
        img {
            max-width: 100%
        }
        code {
            padding: 0.2rem 0.5rem;
            border-radius:0.5rem;
            background: rgb(181, 181, 181)
        }
    </style>
</head>
<body>
    <header>
        <h1>Hydrafiles</h1>
        <p>The web privacy layer.</p>
        <p>Donate Monero:<br>83BGShZv9hU9P9SRLjhRGJYQ4WatMNazKVFG6eKyHc6HguBzu1vH54R7mQJaZzeXhx4jDxnkNJMizLXrFFN4ARffEwFj82y</p>
    </header>

    <section>
        <h2>Hydrafiles Live Demo</h2>
        <p>Your browser is running a full Hydrafiles node right now. You can right click > inspect element, then go to console or network to see what's going on.</p>
        <h3>1. Start Hydrafiles</h3>
        <button id="startHydrafilesButton">Start Hydrafiles</button>
        <h3>2. Known Nodes</h3>
        <button id="fetchNodesButton" disabled>Fetch Nodes</button>
        <ul id="nodes"></ul>
        <h3>3. Fetch File</h3>
        <button id="fetchFileButton" disabled>Fetch File</button>
        <pre id="fileInfo"></pre>
        <h3>4. Fetch File Metadata</h3>
        <button id="fetchFileMetadataButton" disabled>Fetch File Metadata</button>
        <pre id="fileMetadata"></pre>
        <h3>5. Get File Content</h3>
        <button id="getFileContentButton" disabled>Get File Content</button>
        <pre id="fileContent"></pre>
    </section>


    <p style="text-align:center">Free information for the people, by the people.<br>They can't stop us all.</p>

    <!-- TODO: Add UI for users to upload directly from this page. Then integrate some crypto payment contract for guarunteed file storage. -->
    <script type="module">
    import Hydrafiles from './hydrafiles-web.esm.js';
    
    document.getElementById('startHydrafilesButton').addEventListener('click', () => {
        document.getElementById('startHydrafilesButton').style.display = 'none';
        window.hydrafiles = new Hydrafiles();
        window.hydrafiles.start().then(() => {
            console.log('Hydrafiles web node is running', hydrafiles);
            document.getElementById('fetchNodesButton').disabled = false;
        })
    });

    async function displayNodes() {
        const nodeList = window.hydrafiles.nodes.getNodes();
        document.getElementById('fetchNodesButton').style.display = 'none';
        document.getElementById('nodes').innerHTML = nodeList.length === 0 ? "<li>No nodes available</li>" : nodeList.map(node => `<li>${node.host}</li>`).join('');
    }

    document.getElementById('fetchNodesButton').addEventListener('click', async () => {
        document.getElementById('fetchNodesButton').innerText = 'Fetching nodes...';
        setInterval(displayNodes, 1000);
        window.hydrafiles.nodes.add(window.hydrafiles.nodes.nodeFrom('http://localhost'));
        document.getElementById('fetchFileButton').disabled = false;
    });

    let file;
    document.getElementById('fetchFileButton').addEventListener('click', () => {
        document.getElementById('fetchFileButton').style.display = 'none';
        file = window.hydrafiles.getFile("04aa07009174edc6f03224f003a435bcdc9033d2c52348f3a35fbb342ea82f6f");
        file.id = "c8fcb43d6e46";
        document.getElementById('fileInfo').textContent = Object.entries(file).map(([key, value]) => `${key}: ${value}`).join('\n');
        document.getElementById('fetchFileMetadataButton').disabled = false;
    });

    document.getElementById('fetchFileMetadataButton').addEventListener('click', async () => {
        document.getElementById('fetchFileMetadataButton').innerText = 'Fetching Metadata...';
        const metadata = await file.getMetadata()
        document.getElementById('fileMetadata').textContent = Object.entries(metadata).map(([key, value]) => `${key}: ${value}`).join('\n');
        document.getElementById('fetchFileMetadataButton').style.display = 'none';
        document.getElementById('getFileContentButton').disabled = false;
    });

    document.getElementById('getFileContentButton').addEventListener('click', async () => {
        document.getElementById('getFileContentButton').innerText = 'Getting File Content...';
        const fileContent = await file.getFile();
        console.log('File content:', fileContent);
        document.getElementById('fileContent').innerHTML = `Signal Strength: ${fileContent.signal}<br>File Content: Uint8Array(${fileContent.file.length})`;
        document.getElementById('getFileContentButton').style.display = 'none';
    });
    </script>
</body>
</html>
